# BookNLP Docker Compose - Local Development
#
# Usage:
#   docker compose up --build    # Build and start API server
#   curl http://localhost:8000/v1/health  # Check health
#
# API endpoints:
#   GET  /v1/health   - Liveness check
#   GET  /v1/ready    - Readiness check
#   POST /v1/analyze  - Analyze text
#   GET  /docs        - OpenAPI documentation

services:
  booknlp:
    build:
      context: .
      dockerfile: Dockerfile
    image: booknlp:cpu
    container_name: booknlp
    ports:
      - "8000:8000"
    volumes:
      - ./input:/app/input:ro
      - ./output:/app/output
    environment:
      - BOOKNLP_MODEL_PATH=/home/booknlp/booknlp_models
      - BOOKNLP_DEFAULT_MODEL=small
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/v1/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
